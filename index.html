<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Reported Flags Debug</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>
<body>
<h2>Reported Flags Debug</h2>
<div id="flag-count">Loading...</div>
<pre id="flag-data"></pre>

<script>
const REPORTED_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQH2VV-FfOWWKyr4XRaVAPxWL-8zn2dKmYB_2XxxKG_b9IfJVtgGU5xcFje_wh7WW_AyGpDABQpMlFo/pub?gid=27103071&single=true&output=csv';
const csvUrl = REPORTED_CSV_URL + '?cacheBust=' + new Date().getTime();

Papa.parse(csvUrl, {
  download: true,
  header: true,
  skipEmptyLines: true,
  complete: function(results) {
    console.log("All CSV rows:", results.data);

    const reported = results.data.filter(r => r.LP_UNIQUE_REF);
    console.log("Filtered reported rows:", reported);

    document.getElementById('flag-count').textContent = 'Reported Flags: ' + reported.length;

    let output = '';
    reported.forEach(r => {
      output += `${r.LP_UNIQUE_REF} - ${r.Issue_Description} - ${r.Timestamp}\n`;
    });
    document.getElementById('flag-data').textContent = output;
  },
  error: function(err) {
    console.error("CSV parse error:", err);
    document.getElementById('flag-count').textContent = 'Error fetching CSV';
  }
});
</script>
</body>
</html>
